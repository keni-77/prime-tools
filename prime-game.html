<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ç´ æ•°ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</title>
<style>
  body {
    background: #fff5f8;
    font-family: "Hiragino Maru Gothic ProN", "Yu Gothic", sans-serif;
    text-align: center;
    padding-top: 20px;
  }

  h1 {
    color: #ff7aa8;
  }

  #gameArea {
    width: 300px;
    height: 400px;
    background: snow;
    margin: 20px auto;
    border-radius: 15px;
    box-shadow: 0 4px 12px rgba(255,150,180,0.4);
    position: relative;
    overflow: hidden;
  }

  .enemy {
    position: absolute;
    top: -40px;
    left: 0;
    width: 60px;
    height: 40px;
    background: #ffe0ef;
    border-radius: 10px;
    color: #ff4f9a;
    font-size: 1.2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(255,150,180,0.4);
  }

  #score, #miss {
    font-size: 1.4rem;
    color: hotpink;
  }
</style>
</head>
<body>

<h1>ğŸŒ¸ ç´ æ•°ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚° ğŸŒ¸</h1>

<div id="score">ã‚¹ã‚³ã‚¢: 0</div>
<div id="miss">ãƒŸã‚¹: 0 / 3</div>

<div id="gameArea"></div>

<script>
function isPrime(n) {
  if (n < 2) return false;
  if (n === 2) return true;
  if (n % 2 === 0) return false;
  const r = Math.floor(Math.sqrt(n));
  for (let i = 3; i <= r; i += 2) {
    if (n % i === 0) return false;
  }
  return true;
}

const gameArea = document.getElementById("gameArea");
let score = 0;
let miss = 0;

// â˜… æ•µãŒåŒæ™‚ã«å¤§é‡ç™ºç”Ÿã—ãªã„ã‚ˆã†ã«ã™ã‚‹ãƒ•ãƒ©ã‚°
let spawning = false;

function spawnEnemy() {
  // â˜… ã™ã§ã«æ•µãŒè½ä¸‹ä¸­ãªã‚‰æ–°ã—ã„æ•µã‚’ä½œã‚‰ãªã„
  if (spawning) return;
  spawning = true;

  const enemy = document.createElement("div");
  enemy.classList.add("enemy");

  const num = Math.floor(Math.random() * 200) + 1;
  enemy.textContent = num;

  enemy.style.left = Math.floor(Math.random() * 240) + "px";
  gameArea.appendChild(enemy);

  let y = -40;
  const fall = setInterval(() => {
    y += 2;
    enemy.style.top = y + "px";

    if (y > 400) {
      clearInterval(fall);
      enemy.remove();

      // â˜… æ¬¡ã®æ•µã‚’è¨±å¯
      spawning = false;

      if (isPrime(num)) {
        miss++;
        updateMiss();
      }
    }
  }, 20);

  enemy.onclick = () => {
    clearInterval(fall);
    enemy.remove();

    // â˜… æ¬¡ã®æ•µã‚’è¨±å¯
    spawning = false;

    if (isPrime(num)) {
      score++;
      document.getElementById("score").textContent = "ã‚¹ã‚³ã‚¢: " + score;
    } else {
      miss++;
      updateMiss();
    }
  };
}

function updateMiss() {
  document.getElementById("miss").textContent = `ãƒŸã‚¹: ${miss} / 3`;
  if (miss >= 3) {
    alert("ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼ ã‚¹ã‚³ã‚¢: " + score);
    location.reload();
  }
}

// â˜… 1ç§’ã”ã¨ã« spawnEnemy ã‚’å‘¼ã¶ï¼ˆå¤§é‡ç™ºç”Ÿã¯ãƒ•ãƒ©ã‚°ã§é˜²æ­¢ï¼‰
setInterval(spawnEnemy, 1000);
</script>

</body>
</html>
